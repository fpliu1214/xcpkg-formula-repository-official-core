summary: A general-purpose, portable utility library which provides many useful data types, macros, type conversions, string utilities, file utilities, a mainloop abstraction, and so on
web-url: https://developer.gnome.org/glib
git-url: https://github.com/GNOME/glib
src-url: https://download.gnome.org/sources/glib/2.76/glib-2.76.4.tar.xz
src-sha: 5a5a191c96836e166a7771f7ea6ca2b0069c603c7da3cba1cd38d1694a395dda
license: LGPL-2.1-or-later
dep-pkg: libintl libffi libpcre2

dopatch: |
    sedInPlace "s|cc.find_library('resolv')|declare_dependency(link_args : ['-lresolv'])|" gio/meson.build
    sedInPlace "/libiconv =/c libiconv = dependency('libiconv', method : 'pkg-config')" meson.build
    sedInPlace '2087,2114d'  meson.build
    sedInPlace "2086a libintl = cc.find_library('intl',  dirs: ['$libintl_LIBRARY_DIR'])" meson.build
    sedInPlace "2087a core_foundation = dependency('CoreFoundation', method : 'extraframework')" meson.build
    sedInPlace '2088a libintl_deps = [libintl, libiconv, core_foundation]' meson.build
    run cat meson.build

install: |
    mesonw \
        -Dnls=disabled \
        -Dman=false \
        -Dgtk_doc=false \
        -Ddtrace=false \
        -Dglib_debug=disabled \
        -Dglib_assert=false \
        -Dtests=false \
        -Dinstalled_tests=false \
        -Dbsymbolic_functions=false
